<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.com.otc.modular.sys.dao.MessageIdRecordDao">

    <!-- 通用查询映射结果 -->
    <resultMap id="TMessageIdRecord" type="cn.com.otc.modular.sys.bean.pojo.TMessageIdRecord">
        <id column="id" property="id" />
        <result column="redpacket_id" property="redpacketId" />
        <result column="message_id" property="messageId" />
        <result column="share_user_tgid" property="shareUserTgId" />
        <result column="create_time" property="createTime" />
    </resultMap>
    <insert id="createMessageIdRecord">
        REPLACE INTO `t_messageid_record`
            (`redpacket_id`, `message_id`,share_user_tgid, `create_time`) VALUES (#{redpacketId}, #{messageId},#{shareUserTgId}, now());
    </insert>
    <update id="updateMessageIdRecord">
        UPDATE `antwalletbot_server`.`t_messageid_record`
        SET `message_id`      = #{messageId},
            `update_time`      = now()
        WHERE `id` = #{id};

    </update>
    <delete id="delectMessageId">
        DELETE FROM t_messageid_record WHERE redpacket_id=#{redpacketId}
    </delete>
    <select id="selectMessageIdRecord" resultMap="TMessageIdRecord"
            parameterType="java.lang.String">
        SELECT
            id,redpacket_id,message_id,share_user_tgid,create_time,update_time FROM t_messageid_record
        WHERE
            redpacket_id = #{redpacketId}
    </select>
    <select id="selectMessageIdRecordList" resultMap="TMessageIdRecord"
            parameterType="java.lang.String">
        SELECT id,redpacket_id,message_id,share_user_tgid,create_time,update_time FROM t_messageid_record
        WHERE redpacket_id = #{newredpacketId} and share_user_tgid=#{userTGID}
    </select>


</mapper>
